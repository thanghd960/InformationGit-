(function(){var b="$"+String.uniqueID()+"-properties";var c=function(d){return function(e){this[b][d]=e;return this}};var a=function(d){return function(){return this[b][d]||null}};Class.Mutators.Properties=function(e){this.implement(b,e);for(var f in e){var d=f.capitalize().camelCase();this.implement("set"+d,c(f));this.implement("get"+d,a(f))}}})();Class.Binds=new Class({$bound:{},bound:function(a){return this.$bound[a]?this.$bound[a]:this.$bound[a]=this[a].bind(this)}});(function(){var c=Element.NativeEvents,a=window.location,e=a.pathname,f=window.history,b=("pushState" in f),d=b?"popstate":"hashchange";this.History=new new Class({Implements:[Class.Binds,Events],initialize:b?function(){c[d]=2;window.addEvent(d,this.bound("pop"))}:function(){c[d]=1;window.addEvent(d,this.bound("pop"));this.hash=a.hash;var g=("onhashchange" in window);if(!(g&&(document.documentMode===undefined||document.documentMode>7))){this.timer=this.check.periodical(200,this)}},push:b?function(g,i,h){if(e&&e!=g){e=null}f.pushState(h||null,i||null,g);this.onChange(g,h)}:function(g){a.hash=g},replace:b?function(g,i,h){f.replaceState(h||null,i||null,g)}:function(g){this.hash="#"+g;this.push(g)},pop:b?function(h){var g=a.pathname;if(g==e){e=null;return}this.onChange(g,h.event.state)}:function(){var g=a.hash;if(this.hash==g){return}this.hash=g;this.onChange(g.substr(1))},onChange:function(g,h){this.fireEvent("change",[g,h||{}])},back:function(){f.back()},forward:function(){f.forward()},getPath:function(){return b?a.pathname:a.hash.substr(1)},hasPushState:function(){return b},check:function(){if(this.hash!=a.hash){this.pop()}}})}).call(this);History.handleInitialState=function(c){if(!c){c=""}var a=window.location,e=a.pathname.substr(c.length),d=a.hash,b=History.hasPushState();if(!b&&e.length>1){window.location=(c||"/")+"#"+e;return true}if(!d||d.length<=1){return false}if(b){(function(){History.push(d.substr(1))}).delay(1);return false}if(!e||e=="/"){return false}window.location=(c||"/")+d;return true};(function(){var b="$"+String.uniqueID()+"-listener";var a=function(c){var d=new Events,e=d.removeEvent;d.removeEvent=function(f,g){e.call(this,f,g);c.removeEvent(f,g)};return d};this.Listener=new Class({attach:function(c,d){if(!this[b]){this[b]=a(this.toElement())}this[b].addEvent(c,d);this.toElement().addEvent(c,d)}.overloadSetter(),detach:function(c,d){if(this[b]){if(typeof c=="string"){this[b].removeEvent(c,d)}else{this[b].removeEvents(c)}}return this},toElement:function(){return this.element}})})();(function(){var d,c,a,b;if("localStorage" in this){d=this.localStorage;c=function(e,f){d.setItem(e,JSON.encode(f));return this};a=function(e){return JSON.decode(d.getItem(e))};b=function(e){d.removeItem(e);return this}.overloadGetter()}else{d=this.Cookie;c=function(e,f){d.write(e,JSON.encode(f));return this};a=function(e){return JSON.decode(d.read(e))};b=function(e){d.dispose(e);return this}.overloadGetter()}this.LocalStorage={set:c.overloadSetter(),get:a.overloadGetter(),erase:function(){b.apply(this,arguments);return this}}})();(function(){var b={storage:{},store:function(c,d){this.storage[c]=d},retrieve:function(c){return this.storage[c]||null}};Class.Singleton=function(){this.$className=String.uniqueID()};Class.Singleton.prototype.check=function(d){if(!d){d=b}var c=d.retrieve("single:"+this.$className);if(!c){d.store("single:"+this.$className,this)}return c};var a=function(c){var d=c.prototype.$className;return d?this.retrieve("single:"+d):null};if(("Element" in this)&&Element.implement){Element.implement({getInstanceOf:a})}Class.getInstanceOf=a.bind(b)})();(function(){if(!this.Form){this.Form={}}var c=("placeholder" in document.createElement("input"));if(!("supportsPlaceholder" in this)&&this.supportsPlaceholder!==false&&c){return}var a=function(e,d){return function(f,g){if(f=="value"&&!g){d.reset();return this}return e.apply(this,arguments)}};var b=function(e,d){return function(f){if(f=="value"&&!d.hasValue()){return""}return e.apply(this,arguments)}};this.Form.Placeholder=new Class({Implements:[Class.Singleton,Class.Binds,Options],options:{color:"#777"},initialize:function(e,d){this.setOptions(d);e=this.element=document.id(e);return this.check(e)||this.setup()},setup:function(){var d=this.element;this.defaultValue=d.get("placeholder")||d.value;this.color=d.getStyle("color");d.erase("placeholder");d.set=a(d.set,this);d.get=b(d.get,this);this.attach();if(!this.hasValue()){this.reset()}},attach:function(){this.element.addEvents({focus:this.bound("focus"),blur:this.bound("blur")});return this},detach:function(){this.element.removeEvents({focus:this.bound("focus"),blur:this.bound("blur")});return this},clear:function(){var d=this.element;d.setStyle("color",this.color);if(d.value==this.defaultValue){d.value=""}return this},reset:function(){this.element.setStyle("color",this.options.color).value=this.defaultValue;return this},focus:function(){this.clear()},blur:function(){if(!this.element.value){this.reset()}},hasValue:function(){var d=this.element.value;return(d&&d!=this.defaultValue)}})}).call(this);(function(a){this.Interface=new Type("Interface",function(b){if(b.Implements){Array.from(b.Implements).each(function(c){Object.append(this,c)},this);delete b.Implements}return Object.append(this,b)});Class.Mutators.initialize=function(b){return this.prototype.Interface?function(){var n=b.apply(this,arguments);if(!this.Interface){return n}var l=Array.from(this.Interface);for(var f=0;f<l.length;f++){var h=l[f];for(var k in h){if(k.charAt(0)=="$"){continue}if(!(k in this)){throw new Error('Instance does not implement "'+k+'"')}var m=this[k],d=h[k];if(d==null){continue}var j=typeOf(m),e=typeOf(d);if(j!=e&&!instanceOf(m,d)){var g=d.prototype,c=(g&&g.$family)?g.$family().capitalize():d.displayName;throw new Error('Property "'+k+'" is implemented but not an instance of '+(c?'"'+c+'"':"the expected type"))}if(e=="function"&&m.$origin.length<d.length){throw new Error('Property "'+k+'" does not implement at least '+d.length+" parameter"+(d.length!=1?"s":""))}}}return n}:b}}).call(typeof exports!="undefined"?exports:this);